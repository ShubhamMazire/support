(()=>{"use strict";var t=0;window.getNotificationMsgTime=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h:mma";return moment.utc(t).local().format(i)},window.hideNoNotification=function(){$("#noNewNotification").hide()},window.showNoNotification=function(){$("#noNewNotification").show()},window.setTotalNotificationCount=function(t){$(".totalNotificationCount").text(t).attr("data-total_count",t).show(),t>0?($(".read-all-notification").show(),$(".totalNotificationCount").show(),hideNoNotification()):($(".read-all-notification").hide(),$(".totalNotificationCount").hide(),showNoNotification())},window.getMessageByItsTypeForNotificationList=function(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return 1===i?'<i class="fa fa-camera mx-0 text-left" aria-hidden="true"></i> Photo':2===i?'<i class="fa fa-file-pdf-o mx-0 text-left" aria-hidden="true"></i> '+o:3===i?'<i class="fa fa-file-word-o mx-0 text-left" aria-hidden="true"></i> '+o:4===i?'<i class="fa fa-file-audio-o mx-0 text-left" aria-hidden="true"></i> '+o:5===i?'<i class="fa fa-file-video-o mx-0 text-left" aria-hidden="true"></i> '+o:7===i?'<i class="fa fa-file-text-o mx-0 text-left" aria-hidden="true"></i> '+o:8===i?'<i class="fa fa-file-excel-o mx-0 text-left" aria-hidden="true"></i> '+o:t},window.renderNotifications=function(){var i=$.templates("#tmplNotification"),o={getNotificationMsgTime,getMessageByItsTypeForNotificationList},e=i.render(notifications,o);t=notifications.length,setTotalNotificationCount(t),$(".notification__popup").append(e)},renderNotifications(),window.Echo.private("user.".concat(loggedInUserId)).listen("UserEvent",(function(i){if(6!==i.type)return!1;if(-1!=window.location.href.indexOf(conversationsURL)&&getCurrentUserId()===i.owner_id)return!1;hideNoNotification();var o=$(".notification__popup").find("#owner-"+i.owner_id).length,e={getNotificationMsgTime,getMessageByItsTypeForNotificationList};if(o){var n=$.templates("#tmplOldNotification").render(i,e);$("#owner-"+i.owner_id).html(n)}else{t+=1,setTotalNotificationCount(t);var a=$.templates("#tmplNotification").render(i,e);$(".notification__popup").append(a)}})),$(document).on("click",".notification-item",(function(t){t.preventDefault();var i=$(this).data("notification_id"),o=$(this).attr("id");readNotification(i,"#"+o)})),window.readNotification=function(i,o){$.ajax({type:"get",url:"/notification/"+i+"/read",success:function(i){t-=1,setTotalNotificationCount(t);var e=i.data.owner_id;($(o).remove(),displayToastr(Lang.get("messages.success_message.success"),"success",i.message),-1!=window.location.href.indexOf(conversationsURL))?$(document).find("#user-"+e).trigger("click"):window.location.replace(conversationsURL+"?conversationId="+e)},error:function(t){displayToastr(Lang.get("messages.error_message.error"),"error",t.responseJSON.message)}})},window.readNotificationWhenChatWindowOpen=function(i,o){$.ajax({type:"get",url:"/notification/"+i+"/read",success:function(){$(o).remove();var i=$(".notification__popup").find(".notification-item").length;t=i,setTotalNotificationCount(t)},error:function(t){displayToastr(Lang.get("messages.error_message.error"),"error",t.responseJSON.message)}})},window.getCurrentUserId=function(){return $(".chat__person-box--active").data("id")},window.readNotificationWhenOpenChatWindow=function(i){$("#owner-"+i).remove();var o=$(".notification__popup").find(".notification-item").length;t=o,setTotalNotificationCount(t)},$(document).on("click",".read-all-notification",(function(i){if(i.preventDefault(),!t>0)return!1;readAllNotification()})),window.readAllNotification=function(i,o){$.ajax({type:"get",url:"/notification/read-all",success:function(i){var o=i.data.sender_ids;$.each(o,(function(t,i){$("#user-"+i).find(".chat__person-box-count").text(0).hide()})),t=0,setTotalNotificationCount(t),$(".notification__popup").find(".notification-item").remove(),displayToastr(Lang.get("messages.success_message.success"),"success",i.message)},error:function(t){displayToastr(Lang.get("messages.error_message.error"),"error",t.responseJSON.message)}})}})();