(()=>{var e={2238:(e,t,a)=>{const s=a(9602).z,n=a(4593).array;e.exports=class{constructor(e={}){Object.assign(this,{list:e.emptyList&&[]||Array.prototype.concat.apply(s,[n,e.list||[]]),exclude:e.exclude||[],splitRegex:e.splitRegex||/\b/,placeHolder:e.placeHolder||"*",regex:e.regex||/[^a-zA-Z0-9|\$|\@]|\^/g,replaceRegex:e.replaceRegex||/\w/g})}isProfane(e){return this.list.filter((t=>{const a=new RegExp(`\\b${t.replace(/(\W)/g,"\\$1")}\\b`,"gi");return!this.exclude.includes(t.toLowerCase())&&a.test(e)})).length>0||!1}replaceWord(e){return e.replace(this.regex,"").replace(this.replaceRegex,this.placeHolder)}clean(e){return e.split(this.splitRegex).map((e=>this.isProfane(e)?this.replaceWord(e):e)).join(this.splitRegex.exec(e)[0])}addWords(){let e=Array.from(arguments);this.list.push(...e),e.map((e=>e.toLowerCase())).forEach((e=>{this.exclude.includes(e)&&this.exclude.splice(this.exclude.indexOf(e),1)}))}removeWords(){this.exclude.push(...Array.from(arguments).map((e=>e.toLowerCase())))}}},8738:e=>{e.exports=["4r5e","5h1t","5hit","a55","anal","anus","ar5e","arrse","arse","ass","ass-fucker","asses","assfucker","assfukka","asshole","assholes","asswhole","a_s_s","b!tch","b00bs","b17ch","b1tch","ballbag","balls","ballsack","bastard","beastial","beastiality","bellend","bestial","bestiality","bi+ch","biatch","bitch","bitcher","bitchers","bitches","bitchin","bitching","bloody","blow job","blowjob","blowjobs","boiolas","bollock","bollok","boner","boob","boobs","booobs","boooobs","booooobs","booooooobs","breasts","buceta","bugger","bum","bunny fucker","butt","butthole","buttmuch","buttplug","c0ck","c0cksucker","carpet muncher","cawk","chink","cipa","cl1t","clit","clitoris","clits","cnut","cock","cock-sucker","cockface","cockhead","cockmunch","cockmuncher","cocks","cocksuck","cocksucked","cocksucker","cocksucking","cocksucks","cocksuka","cocksukka","cok","cokmuncher","coksucka","coon","cox","crap","cum","cummer","cumming","cums","cumshot","cunilingus","cunillingus","cunnilingus","cunt","cuntlick","cuntlicker","cuntlicking","cunts","cyalis","cyberfuc","cyberfuck","cyberfucked","cyberfucker","cyberfuckers","cyberfucking","d1ck","damn","dick","dickhead","dildo","dildos","dink","dinks","dirsa","dlck","dog-fucker","doggin","dogging","donkeyribber","doosh","duche","dyke","ejaculate","ejaculated","ejaculates","ejaculating","ejaculatings","ejaculation","ejakulate","f u c k","f u c k e r","f4nny","fag","fagging","faggitt","faggot","faggs","fagot","fagots","fags","fanny","fannyflaps","fannyfucker","fanyy","fatass","fcuk","fcuker","fcuking","feck","fecker","felching","fellate","fellatio","fingerfuck","fingerfucked","fingerfucker","fingerfuckers","fingerfucking","fingerfucks","fistfuck","fistfucked","fistfucker","fistfuckers","fistfucking","fistfuckings","fistfucks","flange","fook","fooker","fuck","fucka","fucked","fucker","fuckers","fuckhead","fuckheads","fuckin","fucking","fuckings","fuckingshitmotherfucker","fuckme","fucks","fuckwhit","fuckwit","fudge packer","fudgepacker","fuk","fuker","fukker","fukkin","fuks","fukwhit","fukwit","fux","fux0r","f_u_c_k","gangbang","gangbanged","gangbangs","gaylord","gaysex","goatse","God","god-dam","god-damned","goddamn","goddamned","hardcoresex","hell","heshe","hoar","hoare","hoer","homo","hore","horniest","horny","hotsex","jack-off","jackoff","jap","jerk-off","jism","jiz","jizm","jizz","kawk","knob","knobead","knobed","knobend","knobhead","knobjocky","knobjokey","kock","kondum","kondums","kum","kummer","kumming","kums","kunilingus","l3i+ch","l3itch","labia","lust","lusting","m0f0","m0fo","m45terbate","ma5terb8","ma5terbate","masochist","master-bate","masterb8","masterbat*","masterbat3","masterbate","masterbation","masterbations","masturbate","mo-fo","mof0","mofo","mothafuck","mothafucka","mothafuckas","mothafuckaz","mothafucked","mothafucker","mothafuckers","mothafuckin","mothafucking","mothafuckings","mothafucks","mother fucker","motherfuck","motherfucked","motherfucker","motherfuckers","motherfuckin","motherfucking","motherfuckings","motherfuckka","motherfucks","muff","mutha","muthafecker","muthafuckker","muther","mutherfucker","n1gga","n1gger","nazi","nigg3r","nigg4h","nigga","niggah","niggas","niggaz","nigger","niggers","nob","nob jokey","nobhead","nobjocky","nobjokey","numbnuts","nutsack","orgasim","orgasims","orgasm","orgasms","p0rn","pawn","pecker","penis","penisfucker","phonesex","phuck","phuk","phuked","phuking","phukked","phukking","phuks","phuq","pigfucker","pimpis","piss","pissed","pisser","pissers","pisses","pissflaps","pissin","pissing","pissoff","poop","porn","porno","pornography","pornos","prick","pricks","pron","pube","pusse","pussi","pussies","pussy","pussys","rectum","retard","rimjaw","rimming","s hit","s.o.b.","sadist","schlong","screwing","scroat","scrote","scrotum","semen","sex","sh!+","sh!t","sh1t","shag","shagger","shaggin","shagging","shemale","shi+","shit","shitdick","shite","shited","shitey","shitfuck","shitfull","shithead","shiting","shitings","shits","shitted","shitter","shitters","shitting","shittings","shitty","skank","slut","sluts","smegma","smut","snatch","son-of-a-bitch","spac","spunk","s_h_i_t","t1tt1e5","t1tties","teets","teez","testical","testicle","tit","titfuck","tits","titt","tittie5","tittiefucker","titties","tittyfuck","tittywank","titwank","tosser","turd","tw4t","twat","twathead","twatty","twunt","twunter","v14gra","v1gra","vagina","viagra","vulva","w00se","wang","wank","wanker","wanky","whoar","whore","willies","willy","xrated","xxx"]},4593:(e,t,a)=>{e.exports={object:a(7658),array:a(8738),regex:a(7519)}},7658:e=>{e.exports={"4r5e":1,"5h1t":1,"5hit":1,a55:1,anal:1,anus:1,ar5e:1,arrse:1,arse:1,ass:1,"ass-fucker":1,asses:1,assfucker:1,assfukka:1,asshole:1,assholes:1,asswhole:1,a_s_s:1,"b!tch":1,b00bs:1,b17ch:1,b1tch:1,ballbag:1,balls:1,ballsack:1,bastard:1,beastial:1,beastiality:1,bellend:1,bestial:1,bestiality:1,"bi+ch":1,biatch:1,bitch:1,bitcher:1,bitchers:1,bitches:1,bitchin:1,bitching:1,bloody:1,"blow job":1,blowjob:1,blowjobs:1,boiolas:1,bollock:1,bollok:1,boner:1,boob:1,boobs:1,booobs:1,boooobs:1,booooobs:1,booooooobs:1,breasts:1,buceta:1,bugger:1,bum:1,"bunny fucker":1,butt:1,butthole:1,buttmuch:1,buttplug:1,c0ck:1,c0cksucker:1,"carpet muncher":1,cawk:1,chink:1,cipa:1,cl1t:1,clit:1,clitoris:1,clits:1,cnut:1,cock:1,"cock-sucker":1,cockface:1,cockhead:1,cockmunch:1,cockmuncher:1,cocks:1,cocksuck:1,cocksucked:1,cocksucker:1,cocksucking:1,cocksucks:1,cocksuka:1,cocksukka:1,cok:1,cokmuncher:1,coksucka:1,coon:1,cox:1,crap:1,cum:1,cummer:1,cumming:1,cums:1,cumshot:1,cunilingus:1,cunillingus:1,cunnilingus:1,cunt:1,cuntlick:1,cuntlicker:1,cuntlicking:1,cunts:1,cyalis:1,cyberfuc:1,cyberfuck:1,cyberfucked:1,cyberfucker:1,cyberfuckers:1,cyberfucking:1,d1ck:1,damn:1,dick:1,dickhead:1,dildo:1,dildos:1,dink:1,dinks:1,dirsa:1,dlck:1,"dog-fucker":1,doggin:1,dogging:1,donkeyribber:1,doosh:1,duche:1,dyke:1,ejaculate:1,ejaculated:1,ejaculates:1,ejaculating:1,ejaculatings:1,ejaculation:1,ejakulate:1,"f u c k":1,"f u c k e r":1,f4nny:1,fag:1,fagging:1,faggitt:1,faggot:1,faggs:1,fagot:1,fagots:1,fags:1,fanny:1,fannyflaps:1,fannyfucker:1,fanyy:1,fatass:1,fcuk:1,fcuker:1,fcuking:1,feck:1,fecker:1,felching:1,fellate:1,fellatio:1,fingerfuck:1,fingerfucked:1,fingerfucker:1,fingerfuckers:1,fingerfucking:1,fingerfucks:1,fistfuck:1,fistfucked:1,fistfucker:1,fistfuckers:1,fistfucking:1,fistfuckings:1,fistfucks:1,flange:1,fook:1,fooker:1,fuck:1,fucka:1,fucked:1,fucker:1,fuckers:1,fuckhead:1,fuckheads:1,fuckin:1,fucking:1,fuckings:1,fuckingshitmotherfucker:1,fuckme:1,fucks:1,fuckwhit:1,fuckwit:1,"fudge packer":1,fudgepacker:1,fuk:1,fuker:1,fukker:1,fukkin:1,fuks:1,fukwhit:1,fukwit:1,fux:1,fux0r:1,f_u_c_k:1,gangbang:1,gangbanged:1,gangbangs:1,gaylord:1,gaysex:1,goatse:1,God:1,"god-dam":1,"god-damned":1,goddamn:1,goddamned:1,hardcoresex:1,hell:1,heshe:1,hoar:1,hoare:1,hoer:1,homo:1,hore:1,horniest:1,horny:1,hotsex:1,"jack-off":1,jackoff:1,jap:1,"jerk-off":1,jism:1,jiz:1,jizm:1,jizz:1,kawk:1,knob:1,knobead:1,knobed:1,knobend:1,knobhead:1,knobjocky:1,knobjokey:1,kock:1,kondum:1,kondums:1,kum:1,kummer:1,kumming:1,kums:1,kunilingus:1,"l3i+ch":1,l3itch:1,labia:1,lust:1,lusting:1,m0f0:1,m0fo:1,m45terbate:1,ma5terb8:1,ma5terbate:1,masochist:1,"master-bate":1,masterb8:1,"masterbat*":1,masterbat3:1,masterbate:1,masterbation:1,masterbations:1,masturbate:1,"mo-fo":1,mof0:1,mofo:1,mothafuck:1,mothafucka:1,mothafuckas:1,mothafuckaz:1,mothafucked:1,mothafucker:1,mothafuckers:1,mothafuckin:1,mothafucking:1,mothafuckings:1,mothafucks:1,"mother fucker":1,motherfuck:1,motherfucked:1,motherfucker:1,motherfuckers:1,motherfuckin:1,motherfucking:1,motherfuckings:1,motherfuckka:1,motherfucks:1,muff:1,mutha:1,muthafecker:1,muthafuckker:1,muther:1,mutherfucker:1,n1gga:1,n1gger:1,nazi:1,nigg3r:1,nigg4h:1,nigga:1,niggah:1,niggas:1,niggaz:1,nigger:1,niggers:1,nob:1,"nob jokey":1,nobhead:1,nobjocky:1,nobjokey:1,numbnuts:1,nutsack:1,orgasim:1,orgasims:1,orgasm:1,orgasms:1,p0rn:1,pawn:1,pecker:1,penis:1,penisfucker:1,phonesex:1,phuck:1,phuk:1,phuked:1,phuking:1,phukked:1,phukking:1,phuks:1,phuq:1,pigfucker:1,pimpis:1,piss:1,pissed:1,pisser:1,pissers:1,pisses:1,pissflaps:1,pissin:1,pissing:1,pissoff:1,poop:1,porn:1,porno:1,pornography:1,pornos:1,prick:1,pricks:1,pron:1,pube:1,pusse:1,pussi:1,pussies:1,pussy:1,pussys:1,rectum:1,retard:1,rimjaw:1,rimming:1,"s hit":1,"s.o.b.":1,sadist:1,schlong:1,screwing:1,scroat:1,scrote:1,scrotum:1,semen:1,sex:1,"sh!+":1,"sh!t":1,sh1t:1,shag:1,shagger:1,shaggin:1,shagging:1,shemale:1,"shi+":1,shit:1,shitdick:1,shite:1,shited:1,shitey:1,shitfuck:1,shitfull:1,shithead:1,shiting:1,shitings:1,shits:1,shitted:1,shitter:1,shitters:1,shitting:1,shittings:1,shitty:1,skank:1,slut:1,sluts:1,smegma:1,smut:1,snatch:1,"son-of-a-bitch":1,spac:1,spunk:1,s_h_i_t:1,t1tt1e5:1,t1tties:1,teets:1,teez:1,testical:1,testicle:1,tit:1,titfuck:1,tits:1,titt:1,tittie5:1,tittiefucker:1,titties:1,tittyfuck:1,tittywank:1,titwank:1,tosser:1,turd:1,tw4t:1,twat:1,twathead:1,twatty:1,twunt:1,twunter:1,v14gra:1,v1gra:1,vagina:1,viagra:1,vulva:1,w00se:1,wang:1,wank:1,wanker:1,wanky:1,whoar:1,whore:1,willies:1,willy:1,xrated:1,xxx:1}},7519:e=>{e.exports=/\b(4r5e|5h1t|5hit|a55|anal|anus|ar5e|arrse|arse|ass|ass-fucker|asses|assfucker|assfukka|asshole|assholes|asswhole|a_s_s|b!tch|b00bs|b17ch|b1tch|ballbag|balls|ballsack|bastard|beastial|beastiality|bellend|bestial|bestiality|bi\+ch|biatch|bitch|bitcher|bitchers|bitches|bitchin|bitching|bloody|blow job|blowjob|blowjobs|boiolas|bollock|bollok|boner|boob|boobs|booobs|boooobs|booooobs|booooooobs|breasts|buceta|bugger|bum|bunny fucker|butt|butthole|buttmuch|buttplug|c0ck|c0cksucker|carpet muncher|cawk|chink|cipa|cl1t|clit|clitoris|clits|cnut|cock|cock-sucker|cockface|cockhead|cockmunch|cockmuncher|cocks|cocksuck|cocksucked|cocksucker|cocksucking|cocksucks|cocksuka|cocksukka|cok|cokmuncher|coksucka|coon|cox|crap|cum|cummer|cumming|cums|cumshot|cunilingus|cunillingus|cunnilingus|cunt|cuntlick|cuntlicker|cuntlicking|cunts|cyalis|cyberfuc|cyberfuck|cyberfucked|cyberfucker|cyberfuckers|cyberfucking|d1ck|damn|dick|dickhead|dildo|dildos|dink|dinks|dirsa|dlck|dog-fucker|doggin|dogging|donkeyribber|doosh|duche|dyke|ejaculate|ejaculated|ejaculates|ejaculating|ejaculatings|ejaculation|ejakulate|f u c k|f u c k e r|f4nny|fag|fagging|faggitt|faggot|faggs|fagot|fagots|fags|fanny|fannyflaps|fannyfucker|fanyy|fatass|fcuk|fcuker|fcuking|feck|fecker|felching|fellate|fellatio|fingerfuck|fingerfucked|fingerfucker|fingerfuckers|fingerfucking|fingerfucks|fistfuck|fistfucked|fistfucker|fistfuckers|fistfucking|fistfuckings|fistfucks|flange|fook|fooker|fuck|fucka|fucked|fucker|fuckers|fuckhead|fuckheads|fuckin|fucking|fuckings|fuckingshitmotherfucker|fuckme|fucks|fuckwhit|fuckwit|fudge packer|fudgepacker|fuk|fuker|fukker|fukkin|fuks|fukwhit|fukwit|fux|fux0r|f_u_c_k|gangbang|gangbanged|gangbangs|gaylord|gaysex|goatse|God|god-dam|god-damned|goddamn|goddamned|hardcoresex|hell|heshe|hoar|hoare|hoer|homo|hore|horniest|horny|hotsex|jack-off|jackoff|jap|jerk-off|jism|jiz|jizm|jizz|kawk|knob|knobead|knobed|knobend|knobhead|knobjocky|knobjokey|kock|kondum|kondums|kum|kummer|kumming|kums|kunilingus|l3i\+ch|l3itch|labia|lust|lusting|m0f0|m0fo|m45terbate|ma5terb8|ma5terbate|masochist|master-bate|masterb8|masterbat*|masterbat3|masterbate|masterbation|masterbations|masturbate|mo-fo|mof0|mofo|mothafuck|mothafucka|mothafuckas|mothafuckaz|mothafucked|mothafucker|mothafuckers|mothafuckin|mothafucking|mothafuckings|mothafucks|mother fucker|motherfuck|motherfucked|motherfucker|motherfuckers|motherfuckin|motherfucking|motherfuckings|motherfuckka|motherfucks|muff|mutha|muthafecker|muthafuckker|muther|mutherfucker|n1gga|n1gger|nazi|nigg3r|nigg4h|nigga|niggah|niggas|niggaz|nigger|niggers|nob|nob jokey|nobhead|nobjocky|nobjokey|numbnuts|nutsack|orgasim|orgasims|orgasm|orgasms|p0rn|pawn|pecker|penis|penisfucker|phonesex|phuck|phuk|phuked|phuking|phukked|phukking|phuks|phuq|pigfucker|pimpis|piss|pissed|pisser|pissers|pisses|pissflaps|pissin|pissing|pissoff|poop|porn|porno|pornography|pornos|prick|pricks|pron|pube|pusse|pussi|pussies|pussy|pussys|rectum|retard|rimjaw|rimming|s hit|s.o.b.|sadist|schlong|screwing|scroat|scrote|scrotum|semen|sex|sh!\+|sh!t|sh1t|shag|shagger|shaggin|shagging|shemale|shi\+|shit|shitdick|shite|shited|shitey|shitfuck|shitfull|shithead|shiting|shitings|shits|shitted|shitter|shitters|shitting|shittings|shitty|skank|slut|sluts|smegma|smut|snatch|son-of-a-bitch|spac|spunk|s_h_i_t|t1tt1e5|t1tties|teets|teez|testical|testicle|tit|titfuck|tits|titt|tittie5|tittiefucker|titties|tittyfuck|tittywank|titwank|tosser|turd|tw4t|twat|twathead|twatty|twunt|twunter|v14gra|v1gra|vagina|viagra|vulva|w00se|wang|wank|wanker|wanky|whoar|whore|willies|willy|xrated|xxx)\b/gi},9602:e=>{"use strict";e.exports=JSON.parse('{"z":["ahole","anus","ash0le","ash0les","asholes","ass","Ass Monkey","Assface","assh0le","assh0lez","asshole","assholes","assholz","asswipe","azzhole","bassterds","bastard","bastards","bastardz","basterds","basterdz","Biatch","bitch","bitches","Blow Job","boffing","butthole","buttwipe","c0ck","c0cks","c0k","Carpet Muncher","cawk","cawks","Clit","cnts","cntz","cock","cockhead","cock-head","cocks","CockSucker","cock-sucker","crap","cum","cunt","cunts","cuntz","dick","dild0","dild0s","dildo","dildos","dilld0","dilld0s","dominatricks","dominatrics","dominatrix","dyke","enema","f u c k","f u c k e r","fag","fag1t","faget","fagg1t","faggit","faggot","fagg0t","fagit","fags","fagz","faig","faigs","fart","flipping the bird","fuck","fucker","fuckin","fucking","fucks","Fudge Packer","fuk","Fukah","Fuken","fuker","Fukin","Fukk","Fukkah","Fukken","Fukker","Fukkin","g00k","God-damned","h00r","h0ar","h0re","hells","hoar","hoor","hoore","jackoff","jap","japs","jerk-off","jisim","jiss","jizm","jizz","knob","knobs","knobz","kunt","kunts","kuntz","Lezzian","Lipshits","Lipshitz","masochist","masokist","massterbait","masstrbait","masstrbate","masterbaiter","masterbate","masterbates","Motha Fucker","Motha Fuker","Motha Fukkah","Motha Fukker","Mother Fucker","Mother Fukah","Mother Fuker","Mother Fukkah","Mother Fukker","mother-fucker","Mutha Fucker","Mutha Fukah","Mutha Fuker","Mutha Fukkah","Mutha Fukker","n1gr","nastt","nigger;","nigur;","niiger;","niigr;","orafis","orgasim;","orgasm","orgasum","oriface","orifice","orifiss","packi","packie","packy","paki","pakie","paky","pecker","peeenus","peeenusss","peenus","peinus","pen1s","penas","penis","penis-breath","penus","penuus","Phuc","Phuck","Phuk","Phuker","Phukker","polac","polack","polak","Poonani","pr1c","pr1ck","pr1k","pusse","pussee","pussy","puuke","puuker","qweir","recktum","rectum","retard","sadist","scank","schlong","screwing","semen","sex","sexy","Sh!t","sh1t","sh1ter","sh1ts","sh1tter","sh1tz","shit","shits","shitter","Shitty","Shity","shitz","Shyt","Shyte","Shytty","Shyty","skanck","skank","skankee","skankey","skanks","Skanky","slag","slut","sluts","Slutty","slutz","son-of-a-bitch","tit","turd","va1jina","vag1na","vagiina","vagina","vaj1na","vajina","vullva","vulva","w0p","wh00r","wh0re","whore","xrated","xxx","b!+ch","bitch","blowjob","clit","arschloch","fuck","shit","ass","asshole","b!tch","b17ch","b1tch","bastard","bi+ch","boiolas","buceta","c0ck","cawk","chink","cipa","clits","cock","cum","cunt","dildo","dirsa","ejakulate","fatass","fcuk","fuk","fux0r","hoer","hore","jism","kawk","l3itch","l3i+ch","masturbate","masterbat*","masterbat3","motherfucker","s.o.b.","mofo","nazi","nigga","nigger","nutsack","phuck","pimpis","pusse","pussy","scrotum","sh!t","shemale","shi+","sh!+","slut","smut","teets","tits","boobs","b00bs","teez","testical","testicle","titt","w00se","jackoff","wank","whoar","whore","*damn","*dyke","*fuck*","*shit*","@$$","amcik","andskota","arse*","assrammer","ayir","bi7ch","bitch*","bollock*","breasts","butt-pirate","cabron","cazzo","chraa","chuj","Cock*","cunt*","d4mn","daygo","dego","dick*","dike*","dupa","dziwka","ejackulate","Ekrem*","Ekto","enculer","faen","fag*","fanculo","fanny","feces","feg","Felcher","ficken","fitt*","Flikker","foreskin","Fotze","Fu(*","fuk*","futkretzn","gook","guiena","h0r","h4x0r","hell","helvete","hoer*","honkey","Huevon","hui","injun","jizz","kanker*","kike","klootzak","kraut","knulle","kuk","kuksuger","Kurac","kurwa","kusi*","kyrpa*","lesbo","mamhoon","masturbat*","merd*","mibun","monkleigh","mouliewop","muie","mulkku","muschi","nazis","nepesaurio","nigger*","orospu","paska*","perse","picka","pierdol*","pillu*","pimmel","piss*","pizda","poontsee","poop","porn","p0rn","pr0n","preteen","pula","pule","puta","puto","qahbeh","queef*","rautenberg","schaffer","scheiss*","schlampe","schmuck","screw","sh!t*","sharmuta","sharmute","shipal","shiz","skribz","skurwysyn","sphencter","spic","spierdalaj","splooge","suka","b00b*","testicle*","titt*","twat","vittu","wank*","wetback*","wichser","wop*","yed","zabourah"]}')}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,a),o.exports}(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=$.templates("#tmplChatSendArea").render(),s=$.templates("#tmplNewMsgIndicator").render(),n=$.templates("#tmplBlockMsgText").render(),o=$.templates("#tmplBlockByMsgText").render(),r=$.templates("#tmplHiddenTxtMsg").render(),i=0,c=0,d=[],l=!1,u=[],h=[],g=[],f=!0,m=!1,p=!1,k=!1,v=$(".no-conversation"),_=$(".no-archive-conversation"),b=$(".no-conversation-yet"),w=$(".no-archive-conversation-yet");v.hide(),_.hide(),b.hide(),w.hide(),v.removeClass("d-none"),$(document).ready((function(){"use strict";var e,y="",x="",C=null,I=!0,M="",T=!0,L=!0,U=!1,j=!1,R=[],A=0,S=[],B=$("#chatPeopleBody"),F=$("#archivePeopleBody"),N=$(".chat__not-selected");$(".no-chat-message").toggleClass("d-none "),$("#myTab a").on("hidden.bs.tab",(function(){})),$('input[type="radio"]').iCheck({checkboxClass:"icheckbox_square",radioClass:"iradio_square-blue",increaseArea:"20%"}),window.addEventListener("dragover",(function(e){(e=e||event).preventDefault()}),!1),window.addEventListener("drop",(function(e){(e=e||event).preventDefault()}),!1),window.isInBlockedList=function(e){return-1==$.inArray(e,g)},$.ajax({type:"GET",url:conversationListURL,success:function(e){if(e.success){$(".chat-infy-loader").hide();var t=e.data.conversations;0===t.length&&(b.show(),p=!0),B.append(t.map(prepareContacts).join("")),searchUsers()}},error:function(e){console.log(e)}}),$.ajax({type:"GET",url:archiveConversationListURL,success:function(e){if(e.success){var t=e.data.conversations;0===t.length&&(w.show(),k=!0),F.append(t.map(prepareContacts).join("")),F.find(".chat__person-box-archive").each((function(){$(this).text(Lang.get("messages.chats.un_archive"))})),searchUsers()}},error:function(e){console.log(e)}});var z=$("#textMessage");function E(e){if(L)if(void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var a=window.getSelection();a.removeAllRanges(),a.addRange(t)}else if(void 0!==document.body.createTextRange){var s=document.body.createTextRange();s.moveToElementText(e),s.collapse(!1),s.select()}}function O(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];U=!0;var t=$(".chat-conversation"),a=t.prop("scrollHeight");e||(a/=2),t.scrollTop(a)}function O(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];U=!0;var t=$(".chat-conversation"),a=t.prop("scrollHeight");e||(a/=2),t.scrollTop(a)}$(document).on("click",".chat__person-box",(function(a){c=$(this).attr("is-customer-chat"),m=!1,$(".chat-conversation").html(""),v.hide(),U=!1,f=!0,R=[],A=0,$(".chat__person-box").removeClass("chat__person-box--active"),$(this).addClass("chat__person-box--active"),y=$(a.currentTarget).data("id");var o=getLocalStorageItem("user_"+y),d=userURL+y+"/conversation";$.ajax({type:"GET",url:d,data:{isCustomerChat:c},success:function(a){!0,T=!0,m=!0;var c=a.data.conversations[a.data.conversations.length-1];M=0!==a.data.conversations.length?c.id:0,e=$(".chat__person-box--active").data("id");var d=a.data.user;if(a.success&&e===d.id){var l=a.data.conversations.reverse();y=d.id,x=d.photo_url,$("#user-"+y).find(".user-avatar-img").attr("src",x);var u=prepareChatHeader(d,l);if(d.hasOwnProperty("is_blocked")&&d.is_blocked?u+=r:u+=t,$(".chat__people-body").find(".chat__person-box--active").length<=0)if(!$(".chat__people-body").find("#user-"+d.id).length){var h=prepareNewConversation(d.id,d.name,"",d.photo_url,d.is_online,0);B.prepend(h),$("#user-"+d.id).addClass("chat__person-box--active")}if(d.hasOwnProperty("is_super_admin")&&d.is_super_admin?$(".chat-profile__switch-checkbox").addClass("d-none"):$(".chat-profile__switch-checkbox").removeClass("d-none"),$(".chat__area-wrapper").html(u),d.hasOwnProperty("is_blocked")&&!d.is_blocked||($(".contact-title-status").hide(),$(".contact-status").hide()),d.is_req_send_receive){var g=a.data.chat_request,f=d;return f.chat_req=g,g.from_id==loggedInUserId?(setSendChatReqTemplate(f),$(".chat__area-text").addClass("d-none"),$(".typing").addClass("d-none"),!1):(d.chat_req_id=g.id,setReceiveChatReqTemplate(f),$(".chat__area-text").addClass("d-none"),$(".typing").addClass("d-none"),!1)}v.hide();var p=$(".chat-conversation .unread").first();if(p.before(s),fireReadMessageEvent(l),p.length>0)scrollAtEle(p);else{T=!1;var k=$(".chat-conversation").children().last();scrollAtEle(k)}0===a.data.conversations.length&&addNoMessagesIndicator(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];$(".chat-profile").empty();var a=$.templates("#tmplUserDetails"),s={prepareMedia,getCalenderFormatForLastSeen,disabledIfReported};e.media=t;var n=a.render(e,s);$(".chat-profile").html(n)}(d,a.data.media),getMessageByScroll(),$(".open-profile-menu, .chat-profile__close-btn").on("click",(function(e){profileToggle(),$(this).parents(".dropdown-menu").length&&$(this).parents(".dropdown-menu").removeClass("show"),e.stopPropagation()})),setOpenMessageSearchEvent(),setOpenMsgInfoEvent(),(z=$("#textMessage")).emojioneArea({recentEmojis:!1,saveEmojisAs:"shortname",autocomplete:!0,textcomplete:{maxCount:15,placement:"top"},events:{focus:function(e){E(e[0])}}}),""!==o&&null!==o&&(A=1,z[0].emojioneArea.setText(o),removeLocalStorageItem("user_"+y),$("#btnSend").removeClass("chat__area-send-btn--disable")),z.data("emojioneArea").setFocus(),X();S=[],"",prepareMessageReadInfo(a.data.conversations,[])}if(getLocalStorageItem("reply")){var _=JSON.parse(getLocalStorageItem("reply"));_.user_id==y&&prepareReplyBox(_)}a.data.user.is_blocked_by_auth_user?$(".chat__area-wrapper").append(n):a.data.user.is_blocked&&!a.data.user.is_blocked_by_auth_user&&($(".chat__area-wrapper").append(n),$(".blocked-message-text span").text("You are blocked by this user.")),ce(i>0?1:0),readNotificationWhenOpenChatWindow(y),le()},error:function(e){console.log(e)}}),$(".chat__area-wrapper").on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),$("#fileUpload").modal("show")}))})),window.closeDropDown=function(){$(document).on("click",".chat-profile",(function(){var e=$("#nav-group-members").find("[aria-expanded='true']");e.length&&e.trigger("click")}))},window.prepareMessageReadInfo=function(e,t){$.each(t,(function(e,t){if(t.id!=loggedInUserId){var a={user_id:t.id,name:t.name,photo_url:t.photo_url};groupMembersInfo[t.id]=a}})),$.each(e,(function(e,t){S.push(t)}))},window.checkReqAlreadySent=function(e){return!!e&&0==e.status},window.checkReqAlreadyDeclined=function(e){return!!e&&2==e.status},window.setSendChatReqTemplate=function(e){var t=$.templates("#sendRequestTmpl"),a={checkReqAlreadySent},s=t.render(e,a);$("#conversation-container").html(s)},window.setReceiveChatReqTemplate=function(e){var t=$.templates("#getChatRequestTmpl"),a={checkReqAlreadyDeclined},s=t.render(e,a);$("#conversation-container").html(s)},$(document).on("click","#sendChatRequest",(function(e){var t=$(this).data("id"),a={to_id:t,message:$("#chatRequestMessage-"+t).val()};$.ajax({type:"POST",url:sendChatReqURL,data:a,success:function(e){e.success&&(displayToastr("success","success",e.message),$("#chatRequestMessage-"+t).val(""),$(".request__content-title").text("You have send request to this user."),$(".send__request__message").hide())},error:function(e){displayToastr("error","error",e.responseJSON.message)}})})),$(document).on("click","#acceptChatReq",(function(e){var t={id:$(this).data("id")};$.ajax({type:"POST",url:acceptChatReqURL,data:t,success:function(e){e.success&&(displayToastr("success","success",e.message),$("#user-"+e.data.from_id).trigger("click"))},error:function(e){displayToastr("error","error",e.responseJSON.message)}})})),$(document).on("click","#declineChatReq",(function(e){var t={id:$(this).data("id")};$.ajax({type:"POST",url:declineChatReqURL,data:t,success:function(e){e.success&&(displayToastr("success","success",e.message),$("#user-"+e.data.from_id).find(".chat__person-box-count").addClass("d-none").text(0),$("#user-"+e.data.from_id).trigger("click"))},error:function(e){displayToastr("error","error",e.responseJSON.message)}})})),$(document).on("click",'[data-toggle="lightbox"]',(function(e){e.preventDefault(),$(this).ekkoLightbox()})),$(document).on("click",'[data-toggle="media"]',(function(e){e.preventDefault(),$(this).ekkoLightbox()})),$("body").tooltip({selector:".profile-media",placement:"top",boundary:"window",trigger:"hover"}),window.disabledIfReported=function(e){return null==e?"":"disabled"},$(document).on("click","#open-report-user-modal",(function(){var e=$(this).attr("data-id");$("#reportUserId").val(e),$("#reportUserNote").val(""),$("#reportUserValidationErrorsBox").hide().text(""),$("#reportUserModal").modal("show")})),$(document).on("keyup","#reportUserNote",(function(){$("#reportUserValidationErrorsBox").hide().text("")})),$(document).on("click","#reportUser",(function(){var e=$(this),t=$("#reportUserId").val(),a=$("#reportUserNote").val();if(""===a)return $("#reportUserValidationErrorsBox").show().text("The notes field is required."),!1;e.button("loading");var s={reported_to:t,notes:a};$.ajax({type:"POST",url:reportUserURL,data:s,success:function(e){$("#open-report-user-modal").prop("disabled",!0),displayToastr(Lang.get("messages.success_message.success"),"success",e.message),$("#reportUserModal").modal("hide")},error:function(e){$("#reportUserValidationErrorsBox").show().text(e.responseJSON.message)},complete:function(){e.button("reset")}})})),window.displaySideMedia=function(e){$(".no-photo-found").hide();var t=prepareMedia(e);$(".chat-profile__media-container").append(t),$('[data-toggle="tooltip"]').tooltip()},window.prepareMedia=function(e){return 1===e.message_type?imageRendererInSideMedia(e.message,e.id):2===e.message_type?sideMediaRenderer(e.message,e.file_name,"fa-file-pdf-o",e.id):3===e.message_type?sideMediaRenderer(e.message,e.file_name,"fa-file-word-o",e.id):5===e.message_type?sideMediaRenderer(e.message,e.file_name,"fa-file-video-o",e.id):6===e.message_type?sideMediaRenderer(e.message,e.message,"fa fa-youtube-play",e.id):7===e.message_type?sideMediaRenderer(e.message,e.file_name,"fa-file-text-o",e.id):8===e.message_type?sideMediaRenderer(e.message,e.file_name,"fa-file-excel-o",e.id):4===e.message_type?sideMediaRenderer(e.message,e.file_name,"fa-file-audio-o",e.id):""},window.scrollTop=function(){$(".chat-conversation").scrollTop(50)},window.scrollAtEle=function(e){if(e.length>0){var t=$(".chat-conversation"),a=e.position();t.scrollTop(a.top-100)}};var P=$(".chat-profile");$(document).on("click",".ekko-lightbox",(function(e){e.stopPropagation()})),window.profileToggle=function(){P.hasClass("chat-profile--active")?(P.removeClass("chat-profile--active").addClass("chat-profile--out"),setTimeout((function(){P.toggle()}),300)):(closeMsgInfo(),P.addClass("chat-profile--active").removeClass("chat-profile--out").toggle())},window.closeProfileInfo=function(){P.hasClass("chat-profile--active")&&(P.removeClass("chat-profile--active").addClass("chat-profile--out"),P.toggle())};var D=$(".msg-info");window.setOpenMsgInfoEvent=function(){$(".open-msg-info").on("click",(function(e){var t=$(this).attr("data-message-id");setReadByMessageInfo(t),openMsgInfo(),e.stopPropagation()})),$(".msg-info__close-btn").on("click",(function(e){closeMsgInfo(),e.stopPropagation()}))},window.openMsgInfo=function(){closeProfileInfo(),D.hasClass("msg-info--active")||D.addClass("msg-info--active").removeClass("msg-info--out").show()},window.closeMsgInfo=function(){D.hasClass("msg-info--active")&&(D.removeClass("msg-info--active").addClass("msg-info--out"),D.hide())},window.setReadByContactsInfo=function(e){var t=getMsgInfoFromconversationMessages(e);null!==t&&(showMessageInMessageInfo(t),showConversationInfo(t))},window.setReadByMessageInfo=function(e){var t=getMsgInfoFromconversationMessages(e);null!==t&&showSingleConversationInfo(t)},window.checkReadAtDate=function(e){return null!=e&&""!=e&&"0000-00-00 00:00:00"!=e},window.prepareReadByContactsInfoHtml=function(e){var t=$.templates("#groupMsgReadUnreadInfo"),a={getCalenderFormatForLastSeen,checkReadAtDate};return t.render(e,a)};var Y=$("#remaining-users"),q=$("#remaining-users-list"),H=$("#remaining-users-section"),W=$("#remaining-users-divider"),J=$("#read-by-users"),G=$("#read-by-users-divider"),Q=$("#read-by-users-section"),V=$("#single-msg-divider"),Z=$("#single-msg-section");window.showConversationInfo=function(e){var t=[],a=[];if(null!==e&&(showMessageInMessageInfo(e),$.each(e.read_by,(function(e,s){s.user=groupMembersInfo[s.user_id],null!=s.read_at?t.push(s):a.push(s)}))),resetReadByUsers(),a.length>0){Y.text(a.length+" remaining").attr("data-remaining_count",a.length);var s=prepareReadByContactsInfoHtml(a);q.html(s),W.show(),H.show()}if(J.attr("class","message-"+e.id+"-read-by-users"),J.html(""),t.length>0){var n=prepareReadByContactsInfoHtml(t);J.html(n),G.show(),Q.show()}},window.showSingleConversationInfo=function(e){if(null!==e){W.show(),G.show(),Z.show().html(""),showMessageInMessageInfo(e);var t={getCalenderFormatForLastSeen},a=$.templates("#singleMessageReadInfoTmpl").render(e,t);$("#single-msg-section").html(a)}resetSingleMessageReadByInfo()},window.resetSingleMessageReadByInfo=function(){H.hide(),Q.hide()},window.resetReadByUsers=function(){Y.text("").attr("data-remaining_count",0),q.html(""),W.hide(),H.hide(),J.html(""),G.hide(),Q.hide(),V.hide(),Z.hide().html("")},window.getMsgInfoFromconversationMessages=function(e){var t=null;return $.each(S,(function(a,s){if(s.id==e)return t=s,!1})),t},window.showMessageInMessageInfo=function(e){var t={},a={displayMessage,getChatMagTimeInConversation},s=$.templates("#groupMsgReadUnreadMessage");t.data=e,t.loggedInUserId=loggedInUserId;var n=s.render(t,a);$("#msg-info-container-msg").html(n)},$(document).on("click",(function(){P.hasClass("chat-profile--active")&&(P.removeClass("chat-profile--active").addClass("chat-profile--out"),setTimeout((function(){P.toggle()}),300)),$(".chat__people-wrapper-bar").addClass("fa-bars").removeClass("fa-times"),$(".chat__people-wrapper").addClass("chat__people-wrapper--responsive")})),$(document).on("click",".chat-profile",(function(e){e.stopPropagation()})),$(document).on("click",".chat__people-wrapper",(function(e){e.stopPropagation()})),window.setOpenMessageSearchEvent=function(){$(document).on("focus",".chat__area-action-search-input",(function(){$(".chat__search--conversation").css({opacity:"1"})})),$(".chat__area-action-search-input").on("blur",(function(){$(".chat__search--conversation").css({opacity:".5"})})),$(".open-search-bar").on("click",(function(){$(".chat__area-action").addClass("chat__area-action--open"),$(".chat__area-header").addClass("chat__area-header--active"),$(".chat__area-action-search-input").focus()})),$(".chat__area-action-search-close").on("click",(function(){$(".chat__area-action").removeClass("chat__area-action--open"),$(".chat__area-header").removeClass("chat__area-header--active")}))},$(".chat__people-wrapper-bar").on("click",(function(e){$(this).toggleClass("fa-bars fa-times"),$(".chat__people-wrapper").toggleClass("chat__people-wrapper--responsive"),e.stopPropagation()})),$(".chat__search-responsive-icon").on("click",(function(){$(".chat__people-wrapper").removeClass("chat__people-wrapper--responsive"),$(".chat__people-wrapper-bar").toggleClass("fa-bars fa-times"),$(".chat__search-input").focus()})),$("#nav-icon3").on("click",(function(){$(this).toggleClass("open"),$(".chat__people-wrapper").toggleClass("chat__people-wrapper--responsive")})),$(".chat__chat-contact-item").on("click",(function(){$(".chat__chat-contact .chat__chat-contact-item").removeClass("chat__chat-contact--active"),$(this).addClass("chat__chat-contact--active")})),$('[data-toggle="tooltip"]').tooltip();var K="";function X(){var e="",t="",a=$("#toId").val(),s=$("#fromId").val(),n=checkIsArchiveChat();K={to_id:a,_token:csrfToken,is_archive_chat:n},null!=s&&""!==s&&(K.from_id=s,K.send_by=loggedInUserId),$("#btnSend").on("click",(function(){var e=z[0].emojioneArea.getText().trim();if(""===e)return!1;$(this).addClass("chat__area-send-btn--disable"),K.message=e,storeMessage(K),te(),removeLocalStorageItem("user_"+y)})),z[0].emojioneArea.on("keyup emojibtn.click",(function(a,s){var n=s.keyCode||s.which;"keyup"==s.type&&9!==n&&z[0].emojioneArea.hidePicker();var o=z[0].emojioneArea.getText().trim();if(t=o,s&&13===s.which)return t===e||A?0===o.length?void $("#btnSend").addClass("chat__area-send-btn--disable"):($("#btnSend").removeClass("chat__area-send-btn--disable"),isTyping(),$("#btnSend").addClass("chat__area-send-btn--disable"),K.message=o,storeMessage(K),te(),A=0,removeLocalStorageItem("user_"+y),!0):(e=t,!1);A=0,0===o.length?$("#btnSend").addClass("chat__area-send-btn--disable"):($("#btnSend").removeClass("chat__area-send-btn--disable"),isTyping()),e=t})),z[0].emojioneArea.on("blur",(function(e,t){var s=z[0].emojioneArea.getText().trim();s.length>0&&setLocalStorageItem("user_"+a,s)}))}function ee(){(z=$("#textMessage")).emojioneArea({saveEmojisAs:"shortname",autocomplete:!0,textcomplete:{maxCount:15,placement:"top"},events:{focus:function(e){E(e[0])}}}),z.data("emojioneArea").setFocus()}function te(){z[0].emojioneArea.setText("")}function ae(e,t){return parseInt(e)+parseInt(t)}function se(){var e=[];if($.each(d,(function(t,a){-1===$.inArray(a,e)&&-1===$.inArray(a,u)&&e.push(a)})),u=$.merge(u,e),!(e.length<=0)){d=[];var t=$(".chat__person-box--active").data("id");$.ajax({type:"post",url:readMessageURL,data:{ids:e,_token:csrfToken},success:function(a){if($.each(e,(function(e,t){$(".message-"+t).removeClass("unread")})),1==a.success){var s=a.data.remainingUnread,n=$("#user-"+t).find(".chat__person-box-count"),o=n.text();n.text(s),$("#sidebar-message-count").text()>0&&$("#sidebar-message-count").html(parseInt($("#sidebar-message-count").html())-o),s>0?j=!1:(n.text(0).addClass("d-none"),setTimeout((function(){$(".chat__msg-day-new-msg").parent().remove()}),2e4),U=!1,j=!0)}}})}}function ne(e){var t=F.find("#user-"+e.from_id).length;if($.inArray(y,[e.from_id,e.to_id])>=0){fireReadMessageEventUsingIds([e.id]),f=!1,moveConversationFromArchiveToActiveChat(),setSentOrReceivedMessage(e);var a=B.find("#user-"+e.from_id),s=B.find("#user-"+e.to_id);a.length?addUserToTopOfConversation(e.from_id,a):s.length&&addUserToTopOfConversation(e.to_id,s),moveConversationFromArchiveToActiveChat()}else if(B.find("#user-"+e.from_id).length){e.status||$("#sidebar-message-count").html(parseInt($("#sidebar-message-count").html())+1);var n=B.find("#user-"+e.from_id),o=n.find(".chat__person-box-count").text();0==(o=isNaN(o)||""===o?0:o)&&(i+=1,ce(0));var r=ae(o,1);n.find(".chat__person-box-count").removeClass("d-none"),n.find(".chat__person-box-count").text(r).show(),n.find(".chat-message").html(getMessageByItsTypeForChatList(e.message,e.message_type,e.file_name)),n.find(".chat__person-box-time").text(getLocalDate(e.created_at)),addUserToTopOfConversation(e.from_id,n)}else{e.status||(i+=1,ce(0));var c=0;e.send_by==loggedInUserId&&(c=1);var d=prepareNewConversation(e.from_id,htmlSpecialCharsDecode(e.sender.name),e,e.sender.photo_url,"",c);B.prepend(d);var l=B.find("#user-"+e.from_id);l.find(".chat__person-box-status").removeClass("chat__person-box-status--offline").addClass("chat__person-box-status--online"),e.status&&(l.find(".chat__person-box-count").text(0).show(),l.find(".chat__person-box-count").addClass("d-none")),v.hide(),b.hide(),F.find("#user-"+e.from_id).remove()}t&&(makeConversationArchiveWhenMessageArrive(e.from_id),makeActiveChatTabActive(),showNoArchiveConversationEle())}window.checkIsArchiveChat=function(){return $(".chat__person-box--active").parents("#archivePeopleBody").length},window.moveConversationFromArchiveToActiveChat=function(){var e=$(".chat__person-box--active");e.find(".chat__person-box-archive").text(Lang.get("messages.chats.archive_chat")),$("#chatPeopleBody").prepend(e),$("#archivePeopleBody").find(".chat__person-box--active").remove(),makeActiveChatTabActive(),setNoConversationYet()},window.storeMessage=function(e){var t=new(a(2238));e.message=t.clean(e.message);var s=0;$(".chat__text-preview").length>0&&(s=$(".chat__text-preview").data("message-type"));var n=null;0!=s||e.file_name||(n=function(e){var t=e;t.message=e.message.replace(/(<([^>]+)>)/gi,"");var a=moment().tz(timeZone).format("hh:mma");"1"==isUTCTimezone&&(a=getLocalDate(moment().utc()));t.time=a,t.senderName=authUserName,t.senderImg=authImgURL,t.message=getMessageByItsTypeForChatList(t.message,0);var s=Math.floor(6*Math.random())+Date.now();t.randomMsgId=s,$(".chat__text-preview").length>0?t.receiverName=$(".chat__text-preview").find(".reply-to-user").text():t.receiverName="";var n=$.templates("#tmplSingleMessage").render(t),o=$(".chat__person-box--active").find(".chat__person-box-time").text(),r=$.templates("#tmplToday");"Yesterday"==o||moment(o).isValid()?($(".chat__person-box--active").find(".chat__person-box-time").text(t.time),$(".chat-conversation").append(r)):o||($(".chat-conversation").append(r),$(".chat__person-box--active").find(".chat__person-box-time").text(getLocalDate(moment().utc())));return $(".chat-conversation").append(n),$(".chat__not-selected").hide(),O(),setOpenMsgInfoEvent(),s}(e));var o=checkIsArchiveChat();e.is_archive_chat=o,o&&moveConversationFromArchiveToActiveChat(),$.ajax({type:"POST",url:sendMessageURL,data:e,success:function(t){if(e.reply_to="",!0===t.success){fireAddNewContactIdEvent(e.to_id);var a=t.data.message;S.push(t.data.message),$(".msg-options").find("[data-message-id="+n+"]").attr("data-message-id",a.id),$(".msg-options").find("[data-message-type="+n+"]").attr("data-message-type",a.message_type);var o=!1;0!=s&&(o=!0,setSentOrReceivedMessage(a)),0===a.message_type?($(".chat-conversation").find("[data-message_id="+n+"]").addClass("message-"+a.id).attr("data-message_id",a.id),updateMessageInSenderwindow(a),a.url_details&&($(".message-"+a.id).find(".message").empty(),$(".message-"+a.id).find(".chat-conversation__bubble.clearfix").addClass("max-width-35"),$(".message-"+a.id).find(".message").append(displayMessage(a)))):(6===a.message_type&&$(".chat-conversation").find("[data-message_id="+n+"]").remove(),o||setSentOrReceivedMessage(a));var r=B.find("#user-"+e.to_id);addUserToTopOfConversation(e.to_id,r),setOpenMsgInfoEvent()}getSelectedUserUnreadMsgCount(e.to_id)>0&&O()},error:function(t){e.reply_to="",displayToastr(Lang.get("messages.error_message.error"),"error",t.responseJSON.message),console.log(t),$("#btnSend").removeClass("chat__area-send-btn--disable")}})},window.fireAddNewContactIdEvent=function(e){-1!=$.inArray(e,h)&&(window.livewire.emit("addNewContactId",e),h=jQuery.grep(h,(function(t){return t!=e})))},window.getSelectedUserUnreadMsgCount=function(e){return $("#user-"+e).find(".chat__person-box-count").text()},window.setSentOrReceivedMessage=function(t){var a=prepareChatConversation(t,!1),n=$(".chat-conversation"),o=!1;if(displaySideMedia(t),t.from_id==loggedInUserId)j&&n.append(a),O();else if(o=!!(ae(n.scrollTop(),n.innerHeight())>=n[0].scrollHeight-3),n.append(a),o)O();else{var r=$("#user-"+e).find(".chat__person-box-count"),i=r.text();if(i=ae(i,1),r.text(i),r.removeClass("d-none"),0===n.find(".chat__msg-day-new-msg").length)$(".message-"+t.id).before(s)}$(".chat__not-selected").hide(),v.hide(),updateMessageInSenderwindow(t);var c=B.find("#user-"+t.from_id);c.find(".chat-message").html(getMessageByItsTypeForChatList(t.message,t.message_type,t.file_name)),c.find(".chat__person-box-time").text(getLocalDate(t.created_at)),le()},window.updateMessageInSenderwindow=function(e){var t=B.find("#user-"+e.to_id);t.find(".chat-message").html(getMessageByItsTypeForChatList(e.message,e.message_type,e.file_name)),t.find(".chat__person-box-time").text(getLocalDate(e.created_at))},window.getUnreadMessageIds=function(e){var t=[];return $.each(e,(function(e,a){a.to_id!=loggedInUserId||a.status||t.push(a.id)})),t},window.getUnreadGroupMessageIds=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=[],s=1;return e.length>t||$.each(e,(function(e,n){s<=t&&$(".message-"+n.id).hasClass("unread")&&a.push(n.id),s+=1})),a},window.fireReadMessageEvent=function(e){var t=getUnreadMessageIds(e);fireReadMessageEventUsingIds(t)},window.fireReadMessageEventUsingIds=function(e){if(e.length>0){if(d=$.merge(d,e),!l){setInterval(se,5e3);l=!0}}else j=!0},window.getMessageByItsTypeForChatList=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return 1===t?'<i class="fa fa-camera" aria-hidden="true"></i> Photo':2===t?'<i class="fa fa-file-pdf-o" aria-hidden="true"></i> '+a:3===t?'<i class="fa fa-file-word-o" aria-hidden="true"></i> '+a:4===t?'<i class="fa fa-file-audio-o" aria-hidden="true"></i> '+a:5===t?'<i class="fa fa-file-video-o" aria-hidden="true"></i> '+a:7===t?'<i class="fa fa-file-text-o" aria-hidden="true"></i> '+a:8===t?'<i class="fa fa-file-excel-o" aria-hidden="true"></i> '+a:emojione.shortnameToImage(e)},window.getDraftMessage=function(e){var t=getLocalStorageItem("user_"+e);return null!=t&&'<i class="fa fa-pencil" aria-hidden="true"></i> '+getMessageByItsTypeForChatList(t,0)},window.prepareContacts=function(e){var t=e.user,a=e.user_id,s=0;0==t.is_system&&(s=1),e.send_by==loggedInUserId&&(t=e.receiver,a=e.receiver.id,s=1);var n=$.templates("#tmplConversationsList"),o={getMessageByItsTypeForChatList,getLocalDate,getDraftMessage},r={showStatus:!0,showUserStatus:undefined,contactId:a,contact:e,contactDetail:t,is_online:e.user.is_online,isCustomerChat:s,loggedInUserId},c=n.render(r,o);return e.unread_count>0&&(i+=1,ce(0)),c},window.addUserToTopOfConversation=function(e,t){B.remove("#user-"+e),B.prepend(t)},window.Echo.private("user.".concat(loggedInUserId)).listen("UserEvent",(function(e){1===e.type?function(e){var a=$(".chat__person-box--active").data("id");if(loggedInUserId!=e.blockedTo.id)return;e.isBlocked||a!=e.blockedBy.id?e.isBlocked&&(a==e.blockedBy.id&&($(".chat__area-text").remove(),$(".blocked-message-text").remove(),$(".typing").hide(),$(".chat__area-wrapper").append(o)),$("#user-"+a).find(".chat__person-box-status").hide(),$(".chat-profile__person-status").hide(),g.push(e.blockedBy.id)):($(".typing").show(),$("#user-"+a).find(".chat__person-box-status").show(),$(".chat-profile__person-status").show(),$(".chat__area-wrapper").append(t),$(".hdn-text-message").remove(),$(".blocked-message-text").remove(),ee(),X(),removeValueFromArray(g,a))}(e):2===e.type?(ne(e),window.livewire.emit("clearSearchUsers")):4===e.type?function(e){var t="chat-container__read-status--read",a="chat-container__read-status--unread";$.each(e.ids,(function(s,n){$(".message-"+n).find(".chat-container__read-status").removeClass(a).addClass(t),updateReadMessageInfo(n,e.user_id)}))}(e):5===e.type?function(e){var t=$(".message-"+e.id);removeTimeline(t),function(e,t,a){var s=$(document).find("#user-"+a.from_id);if(null!=e&&0===t.nextAll("#send-receive-direction:first").length){var n=s,o=s.find(".chat__person-box-count").text();if((o=parseInt(o))>1){var r=o-1;n.find(".chat__person-box-count").html(r)}else n.find(".chat__person-box-count").html(0).removeClass("d-none").addClass("d-none");n.find(".chat-message").html(getMessageByItsTypeForChatList(e.message,e.message_type,e.file_name)),n.find(".chat__person-box-time").text(getLocalDate(e.created_at))}else null==a.previousMessage&&s.length>0&&(s.find(".chat-message").html(""),s.find(".chat__person-box-count").text(0).addClass("d-none"));checkAllMsgAndShowNoMsgYet()}(e.previousMessage,t,e),B.find("#user-"+e.from_id).length&&$(".message-"+e.id).remove()}(e):6===e.type&&getCurrentUserId()===e.owner_id?readNotificationWhenChatWindowOpen(e.id,"#owner-"+e.owner_id):7===e.type&&ne(e)})),window.updateReadMessageInfo=function(e,t){if(y!=t)return!1;$.each(S,(function(t,a){if(a.id==e){a.status=1,a.updated_at=moment.utc().format("YYYY-MM-DD hh:mm:ss");var s=$("#msg-read-at-"+e);return s.length>0&&s.text(getCalenderFormatForLastSeen(a.updated_at)),!1}}))},window.makeConversationArchiveWhenMessageArrive=function(e){$.ajax({type:"get",url:deleteConversationUrl+e+"/archive-chat",success:function(){showNoArchiveConversationEle()}})},window.Echo.private("chat").listenForWhisper("start-typing.".concat(loggedInUserId),(function(t){if(e==t.user.id){var a=t.user.name+" Typing...";$(".typing").html(a).show()}})).listenForWhisper("stop-typing.".concat(loggedInUserId),(function(t){e==t.user.id&&$(".typing").html("online").show()})),Echo.join("user-status").here((function(e){setTimeout((function(){$.each(e,(function(e,t){updateUserStatus(t.id,1)}))}),1e3)})).joining((function(e){updateUserStatus(e.id,1)})).leaving((function(e){updateUserStatus(e.id,0)})),window.prepareChatHeader=function(e,t){var a=null!==e.last_seen&&""!=e.last_seen?getCalenderFormatForLastSeen(e.last_seen):Lang.get("messages.chats.never"),s=!1,n="";t.map((function(e){0==s&&1==c&&isloggedInUserAdmin&&(s=e.receiver.id,n=e.sender.id)}));var o=$.templates("#tmplConversation"),r=$(o.render({user:e,toId:0==s?e.id:s,fromId:n,isloggedInUserAdmin,lastSeenTime:a})),i=r.find(".chat-conversation");return i.html(""),null!==t.length&&i.html(t.map(prepareChatConversation).join("")),r.html()},window.prepareChatConversation=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(9===e.message_type){var a=addTimeLineEle(e.created_at,t),s=$.templates("#tmplMessageBadges"),n={getLocalDate};return a+s.render(e,n)}-1===$.inArray(t,[!0,!1])&&(t=!0);var o,r=addTimeLineEle(e.created_at,t),i=!1,c=e.send_by==loggedInUserId&&isloggedInUserAdmin;o=(null==e.send_by||isloggedInUserAdmin)&&(e.from_id==loggedInUserId||c)?"chat-conversation__sender":e.status?"chat-conversation__receiver":"chat-conversation__receiver unread";var d=1==e.status||e.hasOwnProperty("read_by_all_count")&&0===e.read_by_all_count?"chat-container__read-status--read":"chat-container__read-status--unread";o.includes("chat-conversation__receiver")&&(i=!0);var l=!0,u=!0;e.time_from_now_in_min>messageDeleteTime&&(l=!1),e.time_from_now_in_min>u&&(u=!1);var h={},g={displayMessage,getChatMagTimeInConversation},f=$.templates("#tmplMessage");return h.data=e,h.isReceiver=i,h.loggedInUserId=loggedInUserId,h.authImage=$.parseHTML(authImgURL)[0].data,e.send_by==loggedInUserId?h.senderImage=e.sender.photo_url:h.senderImage=null==e.send_by?e.sender.photo_url:e.send_by_user.photo_url,h.senderName=e.sender.name,h.senderIsAdmin=null==e.send_by_user?0:"Admin"==e.send_by_user.roles[0].name,h.authUserName=authUserName,h.needToRemoveOldTimeline=t,h.className=o,h.readUnread=d,h.allowToDelete=l,h.deleteMsgForEveryone=u,r+f.render(h,g)},window.displayMessage=function(e){if(1===e.message_type)return imageRenderer(e.message);if(2===e.message_type)return fileRenderer(e.message,e.file_name,pdfURL);if(3===e.message_type)return fileRenderer(e.message,e.file_name,docsURL);if(5===e.message_type)return videoRenderer(e.message);if(6===e.message_type)return renderYoutubeURL(e.message);if(7===e.message_type)return fileRenderer(e.message,e.file_name,textURL);if(8===e.message_type)return fileRenderer(e.message,e.file_name,xlsURL);if(4===e.message_type)return voiceRenderer(e.message,e.file_name);if(6===checkYoutubeUrl(e.message))return renderMultipleYouTubeUrl(e);if(e.url_details){var t={urlDetails:e.url_details,message:e.message};return $.templates("#tmplLinkPreview").render(t)}return emojione.shortnameToImage(detectUrlFromTextMessage(e.message))},window.checkYoutubeUrl=function(e){return-1!=e.indexOf("youtube.com/watch?v=")?6:0},window.findUrls=function(e){for(var t,a=(e||"").toString(),s=[],n=/(((ftp|https?):\/\/)[\-\w@:%_\+.~#?,&\/\/=]+)|((mailto:)?[_.\w-]+@([\w][\w\-]+\.)+[a-zA-Z]{2,3})/g;null!==(t=n.exec(a));){var o=t[0];s.push(o)}return s},window.renderMultipleYouTubeUrl=function(e){var t=e.from_id!=loggedInUserId?"float-right":"float-left",a=e.from_id!=loggedInUserId?"mr-2":"float-right ml-2",s=findUrls(e.message),n="";return $.each(s,(function(e,t){n+=renderYoutubeURL(t,a)})),n+'<div class="d-inline-block '+t+' mx-1" style="max-width: 500px;">'+e.message+"</div>"},window.addTimeLineEle=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=getCalenderFormatForTimeLine(e),s=a.split(" ").join("_").replace(",",""),n="",o='<div class="chat__msg-day-divider d-flex justify-content-center '+s+'">\n               <span class="chat__msg-day-title">'+a+"</span>\n          </div>";if("Today"==a&&"Today"==$(".chat-conversation").find($(".chat__msg-day-title")).text())return"";if(-1===$.inArray(a,R))n=o,R.push(a);else if(t){var r=$(".chat-conversation").find("."+s);r.length&&($("."+s).remove(),n=o)}return n},window.isTyping=function(){var t=Echo.private("chat");I&&t.whisper("start-typing.".concat(e),{user:{id:loggedInUserId,name:authUserName},typing:!0}),I=!1,clearTimeout(C),C=setTimeout(stopTyping,1e3)},window.stopTyping=function(){I=!0,Echo.private("chat").whisper("stop-typing.".concat(e),{user:{id:loggedInUserId},typing:!0})},window.setNoConversationYet=function(){var e=$("#chatPeopleBody").find(".chat__person-box").length,t=$("#archivePeopleBody").find(".chat__person-box").length;k=!(t>0),(p=!(e>0))?b.show():b.hide(),k?w.show():w.hide()},$(document).on("click","#userListForChat .user-list-chat-select__list-item",(function(){$(".user-list-chat-select .user-list-chat-select__list-item").removeClass("user-list-chat-select__list-item--active"),$(this).addClass("user-list-chat-select__list-item--active"),startNewConversation()})),$(document).on("click","#userListForAssignChat .user-list-chat-select__list-item",(function(){$(".user-list-chat-select .user-list-chat-select__list-item").removeClass("user-list-chat-select__list-item--active"),$(this).addClass("user-list-chat-select__list-item--active");var e=$(".user-list-chat-select__list-item--active input")[0].value,t=$("#notAssignUserId").data("id");$.ajax({type:"POST",url:"assign-to-agent",data:{agentId:e,userId:t},success:function(e){displaySuccessMessage(e.message),$("#addNewChat").modal("hide"),$("#notAssignUserId").hide();var t=Lang.get("messages.ticket.assigned_to")+": "+e.data;$("#assignAgentNameLabel").text(t)},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){}})})),$(document).on("click","#notAssignUserId",(function(e){e.preventDefault(),$("#modalTitle").text(assignToAgentLabel),window.livewire.emit("setIsAssignToAgent",1),$("#addNewChat").modal("show")})),window.startNewConversation=function(){var e=$(".user-list-chat-select__list-item--active input")[0].value,t=$(".user-list-chat-select__list-item--active img").attr("src"),a=$(".user-list-chat-select__list-item--active .add-user-contact-name").text(),s=$(".user-list-chat-select__list-item--active .add-chat-user-role").val(),n=0;0==$(".user-list-chat-select__list-item--active input")[1].value&&(n=1),$("#addNewChat").modal("toggle");var o=$(".chat__people-body").find("#user-"+e).length;F.find("#user-"+e).length?makeArchiveChatTabActive():makeActiveChatTabActive();var r=$(".user-"+e).data("status");if(!o){var i=prepareNewConversation(e,a,"",t,r,n,s);B.prepend(i),h.push(e)}$("#user-"+e).trigger("click"),setNoConversationYet()},window.prepareNewConversation=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=0;""!==a&&(n=a.sender.is_online,i=1);var c=$.templates("#tmplContact"),d={getMessageByItsTypeForChatList,getLocalDate};return c.render({id:e,name:t,photo_url:s,status:n,messageInfo:a,count:i,isCustomerChat:o,userRole:r},d)},window.makeUserOnlineOffline=function(e,t){t?e.find(".chat__person-box-status").removeClass("chat__person-box-status--offline").addClass("chat__person-box-status--online"):e.find(".chat__person-box-status").removeClass("chat__person-box-status--online").addClass("chat__person-box-status--offline")},$("#addNewChat").on("show.bs.modal",(function(){$(".user-list-chat-select .user-list-chat-select__list-item").removeClass("user-list-chat-select__list-item--active"),$("#userListForChat").children("li").removeAttr("style")})),$("#addNewChat").on("hidden.bs.modal",(function(){clearSearchOfBlockedContactsTab(),$("#modalTitle").text(newConversationsLabel)})),window.clearSearchOfBlockedContactsTab=function(){window.livewire.emit("setIsAssignToAgent",0),""!=$("#searchBlockUsers").val()&&window.livewire.emit("clearSearchOfBlockedUsers"),window.livewire.emit("clearSearchUsers"),$("#searchBlockUsers").val("")},window.prepareContactForModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={getGender},s=$.templates("#tmplAddChatUsersList"),n=s.render(e,a);t?$("#userListForChat").append(n):$("#userListForChat").html(n)},window.getGender=function(e){return 1==e?"male":2==e?"female":""},window.prepareBlockedUsers=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$(".no-blocked-user").hide();var a=$.templates("#tmplBlockedUsers"),s=a.render(e);t?$("#blockedUsersList").append(s):$("#blockedUsersList").html(s)},window.searchEleSearchEvent=function(e){e.on("search",(function(){this.value||e.trigger("keyup")}))},window.searchUsers=function(){var e=[],t=$("#searchUserInput");searchEleSearchEvent(t),t.on("keyup",(function(){e=[];var t=$(this).val().toLowerCase(),a=getActiveNavChatTabId();$("#"+a+" .chat__person-box").filter((function(){$(this).toggle($(this).find(".chat__person-box-name").text().toLowerCase().indexOf(t)>-1),e.push($(this).find(".chat__person-box-name").text().toLowerCase().indexOf(t))})),"chatPeopleBody"===a&&ifUserNotPresentShowNoRecordFound(e,"no-conversation"),"archivePeopleBody"===a&&ifUserNotPresentShowNoRecordFound(e,"no-archive-conversation")}))},$(document).on("click","#activeChatTab",(function(){resetSearch()})),$(document).on("click","#archiveChatTab",(function(){resetSearch()})),window.resetSearch=function(){$("#searchUserInput").val("").trigger("keyup")},window.getActiveNavChatTabId=function(){return $(".chat__tab-content").find(".active").attr("id")},window.removeValueFromArray=function(e,t){for(var a=0;a<e.length;a++)e[a]===t&&e.splice(a,1);return e},window.ifUserNotPresentShowNoRecordFound=function(e,t){var a=!1;if($.each(e,(function(e,t){if(t>=0)return a=!0,!1})),a)return $("."+t).hide(),!1;var s=getActiveNavChatTabId();return""!==$("#searchUserInput").val()?("chatPeopleBody"===s&&b.hide(),"archivePeopleBody"===s&&w.hide(),$("."+t).show()):(p&&"chatPeopleBody"===s&&b.show(),k&&"archivePeopleBody"===s&&w.show(),$("."+t).hide()),!0},window.updateUserStatus=function(e,t){var a=B.find("#user-"+e),s=$(".user-"+e),n=$(".chat-user-"+e);if(-1==$.inArray(e,g))if(1==t)a.find(".chat__person-box-status").removeClass("chat__person-box-status--offline").addClass("chat__person-box-status--online"),$("#toId").val()==e&&($(".typing").html("online"),$(".chat-profile__person-status").show().text("online"),$(".chat-profile__person-last-seen").show().text("Online")),s.find(".chat__person-box-status").removeClass("chat__person-box-status--offline").addClass("chat__person-box-status--online"),s.attr("data-status",1),n.removeClass("online").removeClass("offline").addClass("online");else{a.find(".chat__person-box-status").removeClass("chat__person-box-status--online").addClass("chat__person-box-status--offline"),s.find(".chat__person-box-status").removeClass("chat__person-box-status--online").addClass("chat__person-box-status--offline"),s.attr("data-status",0),n.removeClass("online").removeClass("offline").addClass("offline");var o="last seen at: "+getCalenderFormatForLastSeen(Date(),"hh:mma",0);$(".typing").html(o),$(".chat-profile__person-last-seen").show().text(""),$(".chat-profile__person-last-seen").show().text(o),$(".chat-profile__person-status").show().text(""),$(".chat-profile__person-status").show().text(o)}},window.getMessageByScroll=function(){$(".chat-conversation").on("scroll",(function(){if(0===$(this).scrollTop())!0===!!m&&getOldOrNewConversation({isCustomerChat:c,before:M},1,0);else if($(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight-1){var e=[];$(".chat-conversation .unread").each((function(){e.push($(this).data("message_id"))})),e.length>0&&fireReadMessageEventUsingIds(e);var t=$(".chat__person-box--active").find(".chat__person-box-count").text();if((t=isNaN(t)||""===t?0:t)>0&&(T=!!f),!0===T){var a=$(".chat-conversation").children().last().attr("data-message_id");if($(".message-"+a).next().length>0)return;f=!1,getOldOrNewConversation({after:a,isCustomerChat:c},0,1)}}}))},window.getOldOrNewConversation=function(t,a,s){$(".loading-message").removeClass("d-none");var n=userURL+y+"/conversation";$.ajax({type:"GET",url:n,data:t,success:function(n){var o=n.data.user;if(n.success&&e===o.id){var r=n.data.conversations;if($.merge(S,r),r.length>0){if(a){var i=n.data.conversations[n.data.conversations.length-1];M=i.id,$.each(r,(function(e,t){$(".chat-conversation").prepend(prepareChatConversation(t))}));var c=$(".message-"+t.before);scrollAtEle(c),setOpenMsgInfoEvent()}s&&($.each(r,(function(e,t){$(".chat-conversation").append(prepareChatConversation(t,!1))})),setOpenMsgInfoEvent(),fireReadMessageEvent(r))}else a&&!1,s&&(T=!1);U&&s&&O(),$(".loading-message").addClass("d-none")}},error:function(e){console.log(e)}})},window.imageRenderer=function(e){return'<a href="'.concat(e,'" data-fancybox="gallery" data-toggle="lightbox" data-gallery="example-gallery" data-src="').concat(e,'"><img src="').concat(e,'"></a>')},window.pdfRenderer=function(e,t){return'<div class="media-wrapper d-flex align-items-center"><i class="fa fa-file-pdf-o" aria-hidden="true"></i><a href= "'.concat(e,'"  target="blank" class="item"> ').concat(t,"</a></div>")},window.voiceRenderer=function(e,t){return'<div class="media-wrapper d-flex align-items-center p-0"><audio controls><source src="'.concat(e,'" type="audio/mp3">\n            Your browser does not support the audio element.\n        </audio></div>')},window.docRenderer=function(e,t){return'<div class="media-wrapper d-flex align-items-center"><i class="fa fa-file-word-o" aria-hidden="true"></i><a href="'.concat(e,'"\n    target="_blank">').concat(t,"</a></div>")},window.txtRenderer=function(e,t){return'<div class="media-wrapper d-flex align-items-center"><i class="fa fa-file-text-o" aria-hidden="true"></i><a href="'.concat(e,'"\n    target="_blank">').concat(t,"</a></div>")},window.xlsRenderer=function(e,t){return'<div class="media-wrapper d-flex align-items-center"><img class="chat-file-preview" src="'.concat(xlsURL,'" /><a href="').concat(e,'"\n    target="_blank">').concat(t,"</a></div>")},window.fileRenderer=function(e,t,a){return a?'<div class="media-wrapper d-flex align-items-center"><img class="chat-file-preview" src="'.concat(a,'" /><a href= "').concat(e,'"  target="blank" class="item"> ').concat(t,"</a></div>"):'<div class="media-wrapper d-flex align-items-center"><i class="fa '.concat(a,'" aria-hidden="true"></i><a href= "').concat(e,'"  target="blank" class="item"> ').concat(t,"</a></div>")},window.videoRenderer=function(e){return'<div class="chat-media">\n                     <video id="my-video" class="video-js" controls preload="auto" width="640" height="264" data-setup=\'\'>\n                            <source src="'.concat(e,'" type="video/mp4">\n                            <source src="').concat(e,'" type="video/webm">\n                            <p class="vjs-no-js">\n                                To view this video please enable JavaScript, and consider upgrading to a web browser that\n                                <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>\n                            </p>\n                      </video>\n                </div>')},window.renderYoutubeURL=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=getYoutubeEmbedURL(e);return'<iframe width="246" height="246" style="border-radius:8px;" class="'+t+'" src="'.concat(a,'" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>\n            </iframe>')},window.getYoutubeEmbedURL=function(e){var t=e,a=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return a&&11===a[2].length&&(t="https://www.youtube.com/embed/"+a[2]),t},window.format=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DD-MMM-YYYY";return moment(e).format(t)},window.imageRendererInSideMedia=function(e,t){return'<a href="'.concat(e,'" data-fancybox="gallery" data-toggle="media" data-gallery="media-gallery" data-src="').concat(e,'" id="mediaProfile-').concat(t,'"><img src="').concat(e,'"></a>')},window.sideMediaRenderer=function(e,t,a,s){return'<div class="media-wrapper justify-content-center d-flex align-items-center profile-media" id="mediaProfile-'.concat(s,'" title="').concat(t,'" ><a href= "').concat(e,'" target="blank" class="item"> <i class="far fa-file-pdf mx-0" aria-hidden="true" ></i></a></div>')},window.getLocalDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hh:mma";return"0"==isUTCTimezone?moment(e).format(t):moment.utc(e).local().format(t)},window.getChatMagTimeInConversation=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h:mma";return"0"==isUTCTimezone?moment(e).format(t):moment.utc(e).local().format(t)},window.getCalenderFormatForLastSeen=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hh:mma",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=a?moment.utc(e).local():moment(e);return s.calendar(null,{sameDay:"[Today], "+t,lastDay:"[Yesterday], "+t,lastWeek:"dddd, "+t,sameElse:function(){return moment().year()===moment(e).year()?"MMM D, "+t:"MMM D YYYY, "+t}})},window.getCalenderFormatForTimeLine=function(e){return moment.utc(e).local().calendar(null,{sameDay:"[Today]",lastDay:"[Yesterday]",lastWeek:"dddd, MMM Do",sameElse:function(){return moment().year()===moment(e).year()?"dddd, MMM Do":"dddd, MMM Do YYYY"}})},window.addNoMessagesIndicator=function(){var e=$.templates("#tmplNoMessagesYet").render();$("#conversation-container").html(e)},window.detectUrlFromTextMessage=function(e){return e.replace(/((http|https|ftp):\/\/[a-z-0-9\w?=&.\/-;#~%-]+(?![a-z-0-9\w\s?&.\/;#~%"=-]*>))/g,"<a href='$1' target='_blank'>$1</a>")},window.addNoConversationIndicator=function(){var e=$.templates("#tmplConversationYet").render();$(".chat__area-wrapper").html(e)},window.fireSwal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(deleteHeading,"!"),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lang.get("messages.swal_message.chat_message_delete"),s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e3;Swal.fire({icon:e,title:t,text:a,customClass:{confirmButton:"btn btn-primary btn-lg"},confirmButtonText:Lang.get("messages.common.ok"),timer:s})};var oe=Swal.mixin({customClass:{actions:"flex-row-reverse"},confirmButtonColor:"#00b0b0",cancelButtonColor:"#C1C1C1"});function re(e){$(".chat__area-text").remove(),$(".blocked-message-text").remove(),$(".block-unblock-span").text("Unblock"),$(".chat__area-wrapper").append(n),$(".chat-user-"+e.id).remove(),$(".typing").hide(),$("#user-"+e.id).find(".chat__person-box-status").hide(),$(".chat-profile__person-status").hide(),$("#user-"+e.id).find(".contact-status").hide(),$(".contact-title-status").hide(),prepareBlockedUsers({users:e},!0)}function ie(e,t){var a=!!e.is_blocked;$.ajax({url:userURL+t+"/block-unblock",type:"PUT",data:e,success:function(e){if(e.success){displayToastr(Lang.get("messages.success_message.success"),"success",e.message);var s=e.data.user;a?(fireAddNewBlockedIdEvent(t),re(s)):(fireRemoveBlockedIdEvent(t),re(s))}},error:function(e){displayToastr(Lang.get("messages.error_message.error"),"error",e.responseJSON.message)}})}function ce(e){if(0===(i-=e)||i<1)$("title").text("Conversations | "+appName);else{var t=i>99?"(99+)":"("+i+")";$("title").text(t+" | Conversations | "+appName)}}function de(e){$("#mediaProfile-"+e).remove();var t=$(".chat-profile__media-container").children().length;1!=t&&0!=t||$(".no-photo-found").show()}function le(){$('[data-toggle="tooltip"]').tooltip()}$(document).on("click",".chat__person-box-delete",(function(t){var a=$(this),s=a.parents(".chat__person-box").data("id"),n=a.parents(".chat__person-box").attr("is-customer-chat"),o=$("#user-"+s).find(".contact-name").text().toString().trim();oe.fire({title:"".concat(deleteHeading," !"),html:Lang.get("messages.chats.delete_chat")+' "'+o+'" ?',icon:"warning",showCancelButton:!0,showConfirmButton:!0,cancelButtonText:Lang.get("messages.common.no"),confirmButtonText:Lang.get("messages.common.yes")}).then((function(t){t.value&&function(t,a){$.ajax({type:"get",url:deleteConversationUrl+t+"/delete",data:{isCustomerChat:a},success:function(a){if(!0!==a.success)return!1;fireSwal("success",Lang.get("messages.common.deleted")+"!",Lang.get("messages.chats.conversation_deleted")+"!");var s=!1;if(e===t){var n=$("#user-"+e).parents(".contact-area");0===n.length&&(n=$("#user-"+e));var o=n.nextAll(".contact-area:first").find(".chat__person-box");if(0===o.length&&(o=n.nextAll(".chat__person-box:first")),o.length>0)$("#user-"+o.data("id")).trigger("click");else{var r=n.prevAll(".contact-area:first").find(".chat__person-box");0===r.length&&(r=n.prevAll(".chat__person-box:first")),r.length&&$("#user-"+r.data("id")).trigger("click"),0===r.length&&(s=!0)}0===o.length&&s&&(s=!0)}var i=$("#user-"+t).parents(".contact-area");0===i.length&&(i=$("#user-"+t));var c=i.parents("#chatPeopleBody"),d=i.parents("#archivePeopleBody");if(i.remove(),s){var l=$("#chatPeopleBody").find(".chat__person-box:first");l.length>0&&$("#user-"+l.data("id")).trigger("click")}c.length>0&&0===B.find(".chat__person-box").length&&(setNoConversationYet(),addNoConversationIndicator(),y=0),d.length>0&&0===$("#archivePeopleBody").find(".chat__person-box").length&&(setNoConversationYet(),addNoConversationIndicator(),y=0)}})}(s,n)})),t.stopPropagation()})),$(document).on("click",".chat__person-box-archive",(function(e){var t=$(this),a=t.parents(".chat__person-box").data("id"),s=t.parents(".chat__person-box").attr("is-customer-chat"),n=$(this).parents("#archivePeopleBody").length,o=$("#user-"+a).find(".contact-name").text(),r=n?Lang.get("messages.chats.un_archive"):Lang.get("messages.chats.archive");oe.fire({title:Lang.get("messages.chats.are_you_sure"),html:r+" "+Lang.get("messages.chats.chat_with")+" <b>"+o+"</b>&nbsp;?",icon:"warning",showCancelButton:!0,confirmButtonText:Lang.get("messages.common.yes"),cancelButtonText:Lang.get("messages.common.no")}).then((function(e){e.value&&archiveConversation(a,s)})),e.stopPropagation()})),window.archiveConversation=function(e,t){$.ajax({type:"get",url:deleteConversationUrl+e+"/archive-chat",data:{isCustomerChat:t},success:function(t){if(!0===t.success){t.data.archived?fireSwal("success",Lang.get("messages.chats.archived")+" !",Lang.get("messages.chats.conversation_archived")+" !"):fireSwal("success",Lang.get("messages.chats.un_archived")+" !",Lang.get("messages.chats.conversation_unarchived")+" !");var a=$("#user-"+e);$("#user-"+e).remove(),t.data.archived?(a.find(".chat__person-box-archive").text(Lang.get("messages.chats.un_archive")),F.append(a),makeArchiveChatTabActive()):(a.find(".chat__person-box-archive").text(Lang.get("messages.chats.archive_chat")),B.append(a),makeActiveChatTabActive()),setNoConversationYet()}}})},window.makeActiveChatTabActive=function(){$('.nav-item a[href="#chatPeopleBody"]').tab("show")},window.makeArchiveChatTabActive=function(){$('.nav-item a[href="#archivePeopleBody"]').tab("show")},window.showNoArchiveConversationEle=function(){0===F.find(".chat__person-box").length?_.show():_.hide()},window.showNoActiveConversationEle=function(){0===B.find(".chat__person-box").length?v.show():v.hide()},window.removeTimeline=function(e){var t=e.prev(".chat__msg-day-divider");t.length&&(0===e.next().length&&t.remove())},window.checkAllMsgAndShowNoMsgYet=function(){var e=$("#conversation-container"),t=e.find(".chat-conversation__sender").length,a=e.find(".chat-conversation__receiver").length,s=$(".chat-conversation").find("#message-badges").length;if(0===t&&0===a&&0===s){var n=$(".chat__person-box--active");e.html(""),N.show(),addNoMessagesIndicator(),n.find(".chat-message").text(""),n.find(".chat__person-box-time").text("")}},window.deleteMsgForEveryone=function(e,t){$.ajax({type:"post",url:"/conversations/"+e+"/delete",data:{previousMessageId:t},success:function(t){if(!0===t.success){var a=t.data.previousMessage;fireSwal("success",Lang.get("messages.swal_message.delete"),Lang.get("messages.swal_message.chat_message_delete"));var s=$(".message-"+e);if(removeTimeline(s),de(e),null!=a&&0===s.nextAll("#send-receive-direction:first").length){var n=$(".chat__person-box--active");n.find(".chat-message").html(getMessageByItsTypeForChatList(a.message,a.message_type,a.file_name)),n.find(".chat__person-box-time").text(getLocalDate(a.created_at))}s.remove(),checkAllMsgAndShowNoMsgYet()}},error:function(e){displayToastr(Lang.get("messages.error_message.error"),"error",e.responseJSON.message)}})},window.deleteMessageFromChat=function(e,t){$.ajax({type:"post",url:deleteMessageUrl+e+"/delete",data:{previousMessageId:t},success:function(t){if(!0===t.success){var a=t.data.previousMessage;fireSwal("success",Lang.get("messages.swal_message.delete"),Lang.get("messages.swal_message.chat_message_delete"));var s=$(".message-"+e);if(removeTimeline(s),de(e),null!=a&&0===s.nextAll("#send-receive-direction:first").length){var n=$(".chat__person-box--active");n.find(".chat-message").html(getMessageByItsTypeForChatList(a.message,a.message_type,a.file_name)),n.find(".chat__person-box-time").text(getLocalDate(a.created_at))}s.remove(),checkAllMsgAndShowNoMsgYet()}},error:function(e){displayToastr(Lang.get("messages.error_message.error"),"error",e.responseJSON.message)}})},Echo.private("updates").listen("UpdatesEvent",(function(e){if(1==e.type){var t=e.user;$("#userListForChat").find(".chat-user-"+t.id).find("img").attr("src",t.photo_url),$("#userListForChat").find(".chat-user-"+t.id).find(".add-user-contact-name").text(t.name),$("#user-"+t.id).find("img").attr("src",t.photo_url),$("#user-"+t.id).find(".contact-name").text(t.name),$(".user-chat-image-"+t.id).attr("src",t.photo_url).attr("data-original-title",t.name)}3==e.type&&updateUserStatus(e.user_id,e.status)})),$(document).on("click",".msg-delete-for-everyone",(function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent().data("message_id"),a=$(".message-"+t),s=a.prevAll("#send-receive-direction:first"),n=0,o=a.prev("#message-badges");o.length?n=o.data("message_id"):s.length&&(n=s.data("message_id")),oe.fire({title:"".concat(deleteHeading," !"),html:"".concat(deleteMessage,' "').concat(Lang.get("messages.swal_message.message"),'" ?'),icon:"warning",showCancelButton:!0,confirmButtonText:Lang.get("messages.common.yes"),cancelButtonText:Lang.get("messages.common.no"),confirmButtonColor:"#33b0b0"}).then((function(e){e.value&&deleteMsgForEveryone(t,n)})),e.stopPropagation()})),$(document).on("click",".msg-delete-icon",(function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent().data("message_id"),a=$(".message-"+t),s=a.prevAll("#send-receive-direction:first"),n=0,o=a.prev("#message-badges");o.length?n=o.data("message_id"):s.length&&(n=s.data("message_id")),oe.fire({title:"".concat(deleteHeading," !"),html:"".concat(deleteMessage," ").concat(Lang.get("messages.swal_message.message")," ?"),icon:"warning",showCancelButton:!0,confirmButtonText:Lang.get("messages.common.yes"),cancelButtonText:Lang.get("messages.common.no"),confirmButtonColor:"#33b0b0"}).then((function(e){e.value&&deleteMessageFromChat(t,n)})),e.stopPropagation()})),window.fireAddNewBlockedIdEvent=function(e){e=parseInt(e),g.push(e),window.livewire.emit("addNewBlockedContactId",e),window.livewire.emit("addBlockedUserId",e)},window.fireRemoveBlockedIdEvent=function(e){e=parseInt(e),window.livewire.emit("removeBlockedContactId",e),window.livewire.emit("removeBlockedUserId",e),g=jQuery.grep(g,(function(t){return t!=e}))},$(document).on("click",".btn-unblock",(function(e){var t=this;e.preventDefault(),oe.fire({title:Lang.get("messages.chats.are_you_sure"),html:Lang.get("messages.chats.unblock_this_user"),icon:"warning",showCancelButton:!0,confirmButtonText:Lang.get("messages.common.yes"),cancelButtonText:Lang.get("messages.common.no"),confirmButtonColor:"#6777ef"}).then((function(e){if(e.value){L=!1;var a=$(t).data("id");ie({is_blocked:!1,blocked_to:a},a)}}))})),$(document).on("click",".block-unblock-user-switch",(function(e){var t=$(this).is(":checked"),a=$("#senderId").val(),s={};s.is_blocked=t,s.blocked_to=a,oe.fire({title:Lang.get("messages.chats.are_you_sure"),html:t?Lang.get("messages.chats.you_want_block_this_user"):Lang.get("messages.chats.you_want_unblock_this_user"),icon:"warning",showCancelButton:!0,confirmButtonText:Lang.get("messages.common.yes"),cancelButtonText:Lang.get("messages.common.no"),confirmButtonColor:"#6777ef"}).then((function(e){e.value?ie(s,a):$(".block-unblock-user-switch").prop("checked",!t)}))})),window.displayPhoto=function(e,t){var a=!0;if(e.files&&e.files[0]){var s=new FileReader;s.onload=function(e){var s=new Image;s.src=e.target.result,s.onload=function(){$(t).attr("src",e.target.result),a=!0}},a&&(s.readAsDataURL(e.files[0]),$(t).show())}},""!==conversationId&&setTimeout((function(){$(document).find("#user-"+conversationId).trigger("click")}),6e3),window.addEventListener("paste",(function(e){!function(e,t,a){0==e.clipboardData&&"function"==typeof t&&t(void 0);var s=e.clipboardData.items;null==s&&"function"==typeof t&&t(void 0);for(var n=function(e){if(-1==s[e].type.indexOf("image"))return"continue";var n=s[e].getAsFile(),o=document.createElement("canvas"),r=o.getContext("2d"),i=new Image;i.onload=function(){o.width=this.width,o.height=this.height,r.drawImage(i,0,0),"function"==typeof t&&t(o.toDataURL(a||"image/png"))};var c=window.URL||window.webkitURL;i.src=c.createObjectURL(n)},o=0;o<s.length;o++)n(o)}(e,(function(e){if(!(y>0||""!=y))return!1;if(e){var t=$.templates("#copyPastImgTmplt").render({url:e});$("#imageCanvas").append(t),$("#copyImageModal").modal("show")}}))}),!1),$(document).on("click","#sendImages",(function(e){var t=[],a=$("#imageCanvas").find(".img-thumbnail");$.each(a,(function(e,a){t.push($(this).attr("src"))}));var s={to_id:y,message_type:1,images:t};$.ajax({type:"POST",url:imageUploadURL,data:s,success:function(e){$.each(e.data,(function(e,t){setSentOrReceivedMessage(t)})),resetImageCanvas(),$("#copyImageModal").modal("hide")},error:function(e){displayToastr(Lang.get("messages.error_message.error"),"error",e.responseJSON.message)}})})),$(document).on("click",".remove-img",(function(e){$(this).parent().remove()})),$("#copyImageModal").on("hidden.bs.modal",(function(){resetImageCanvas()})),window.resetImageCanvas=function(){$("#imageCanvas").html("")}}));var y="",x=[];$("#submit-all").hide(),$("#cancel-upload-file").hide(),window.Dropzone.options.dropzone={thumbnailWidth:125,acceptedFiles:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.mp4,.mkv,.avi,.txt,.mp3,.ogg,.wav,.aac,.alac",timeout:5e4,autoProcessQueue:!1,parallelUploads:10,addRemoveLinks:!0,dictRemoveFile:'<i class="fa fa-trash-o" title="Remove" style="color: indianred;"></i>',uploadMultiple:!0,dictCancelUpload:"",init:function(){var e=document.querySelector("#submit-all"),t=document.querySelector("#cancel-upload-file");function a(e,t,a){var s=e.name.split(".").pop();"pdf"==s?$(e.previewElement).find(".dz-image img").attr("src","/assets/img/pdf_icon.png"):-1!=s.indexOf("doc")||-1!=s.indexOf("docx")?$(e.previewElement).find(".dz-image img").attr("src","/assets/img/doc_icon.png"):-1==s.indexOf("xls")&&-1==s.indexOf("xlsx")&&-1==s.indexOf("csv")||$(e.previewElement).find(".dz-image img").attr("src","/assets/img/xls_icon.png"),$(".dz-image").last().find("img").attr({width:"100%",height:"100%"})}y=this,e.addEventListener("click",(function(){$(".dz-progress").show(),y.processQueue()})),t.addEventListener("click",(function(){y.removeAllFiles(!0),$("#fileUpload").modal("toggle")})),this.on("addedfile",(function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;$("#submit-all,#cancel-upload-file").show(),$(".dz-progress").hide(),$(".dz-remove").html(""),$(".dz-remove").addClass("fas fa-trash text-danger mt-3"),a(e,t,s)})),this.on("removedfile",(function(){0===this.getQueuedFiles().length&&$("#submit-all,#cancel-upload-file").hide()}))},complete:function(e){this.getQueuedFiles().length>0&&this.processQueue(),this.files.push(e),this.on("queuecomplete",(function(){$("#fileUpload").modal("toggle"),this.removeAllFiles(!0),x=[]}))},success:function(e,t){$.each(t.data,(function(e,t){var a=$("#toId").val(),s=$("#fromId").val(),n={to_id:a,message:t.attachment,message_type:t.message_type,file_name:t.file_name};null!=s&&""!==s&&(n.from_id=s,n.send_by=loggedInUserId),-1===$.inArray(t.unique_code,x)&&(storeMessage(n),x.push(t.unique_code))}))},error:function(t,a){var s;return"object"===e(a)&&(a=a.hasOwnProperty("message")?a.message:"There is some error, Please try after some time"),displayToastr(Lang.get("messages.error_message.error"),"error",a),null!=(s=t.previewElement)?s.parentNode.removeChild(t.previewElement):void 0}},$("#fileUpload").on("hidden.bs.modal",(function(){$("#submit-all,#cancel-upload-file").hide(),y.removeAllFiles(!0)})),$(document).on("mouseleave",".chat__person-box",(function(){$(".more-btn-conversation-item").removeClass("show")}))})()})();